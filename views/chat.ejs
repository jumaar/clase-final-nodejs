<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Chat Protegido</title>

  <!-- Vinculamos la hoja de estilos externa para el chat -->
  <link rel="stylesheet" href="/css/chat.css">
</head>

<body>
  <!--
    Elemento oculto para pasar datos del servidor (EJS) al cliente (JavaScript).
    Incrustamos el nombre de usuario en un atributo data-username.
    Nuestro script 'chat.js' leerá este valor para identificarse.
  -->
  <div id="user-info" data-username="<%= user.username %>" style="display: none;"></div>

  <!-- Esta es la estructura HTML del chat, también de client/index.html -->
  <section id="chat">
    <header class="chat-header">
      <span>Bienvenido, <%= user.username %></span>
      <button id="logout-button">Cerrar Sesión</button>
    </header>
    <ul id="messages"></ul>
    <form id="form">
      <input type="text" name="message" id="input" placeholder="Escribe un mensaje..." autocomplete="off" />
      <button type="submit">Enviar</button>
    </form>
  </section>

  <!--
    Aquí está la magia de la integración.
    Cargamos el script del chat que externalizamos antes.
    La ruta '/js/chat.js' funcionará porque en el siguiente paso
    le diremos a Express que la carpeta 'public' es nuestro directorio de estáticos.
  -->
  <script type="module" src="/js/chat.js"></script>
</body>

</html>
